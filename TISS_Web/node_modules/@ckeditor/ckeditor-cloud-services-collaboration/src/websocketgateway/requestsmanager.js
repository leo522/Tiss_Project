/*
 *             Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import _0x4b91c0 from'../ckeditorcloudserviceserror.js';class WebSocketRequest{constructor(_0x379bf0,_0x5b91db){this['_context']=_0x379bf0,this['_deferredPromise']=(function(){let _0x89a9a1,_0x2ee269;const _0x1e2e13=new Promise((_0x4baa3d,_0x405cf2)=>{_0x89a9a1=_0x4baa3d,_0x2ee269=_0x405cf2;});return{'resolve':_0x89a9a1,'reject':_0x2ee269,'promise':_0x1e2e13};}()),this['timeout']=setTimeout(()=>this['error'](new _0x4b91c0('Request\x20timeout.',this['_context'])),_0x5b91db);}get['promise'](){return this['_deferredPromise']['promise'];}['response'](_0x4a9485){this['_deferredPromise']['resolve'](_0x4a9485);}['error'](_0x30a463){this['_deferredPromise']['reject'](_0x30a463);}}export default class WebSocketGatewayRequestsManager{constructor(_0x2c711c){this['_context']=_0x2c711c,this['_requests']=new Set();}async['send'](_0x4d2845,_0x25c4e0=0xafc8){const _0x35c83b=this['_createRequest'](_0x25c4e0);try{return _0x4d2845(_0x35c83b),await _0x35c83b['promise'];}finally{this['_finishRequest'](_0x35c83b);}}['errorAll'](_0x598fa8){for(const _0x351d56 of this['_requests'])_0x351d56['error'](_0x598fa8);}['waitForAllRequests'](_0x13867c=0xafc8){return this['_waitForRequests'](_0x13867c);}['_createRequest'](_0x4d9ea9){const _0x747b1c=new WebSocketRequest(this['_context'],_0x4d9ea9);return this['_requests']['add'](_0x747b1c),_0x747b1c;}['_finishRequest'](_0x430bf4){this['_requests']['delete'](_0x430bf4),clearTimeout(_0x430bf4['timeout']);}async['_waitForRequests'](_0x5294b9=0x1388,_0x1b4de5=0x0){return!this['_requests']['size']||_0x1b4de5>=_0x5294b9/0x1f4?Promise['resolve']():(await new Promise(_0x4ed09a=>{setTimeout(_0x4ed09a,0x1f4);}),this['_waitForRequests'](_0x5294b9,_0x1b4de5++));}}