/*
 *             Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import{Command as _0x13cbca,Plugin as _0x1e980c}from'@ckeditor/ckeditor5-core/dist/index.js';import{ButtonView as _0x4256ab,MenuBarMenuListItemButtonView as _0xe660d7,SpinnerView as _0xdb7b88,Notification as _0xc61cdb}from'@ckeditor/ckeditor5-ui/dist/index.js';function f(){const _0x4a0003=[],_0x112242=[];for(const _0x5217db of Array['from'](document['styleSheets'])){if(_0x5217db['ownerNode']['hasAttribute']('data-cke')){for(const _0x2bd823 of Array['from'](_0x5217db['cssRules']))-0x1!==_0x2bd823['cssText']['indexOf']('.ck-content')?_0x4a0003['push'](_0x2bd823['cssText']):-0x1!==_0x2bd823['cssText']['indexOf'](':root')&&_0x112242['push'](_0x2bd823['cssText']);}}return _0x4a0003['length']||console['warn']('The\x20editor\x20stylesheet\x20could\x20not\x20be\x20found\x20in\x20the\x20document.\x20Check\x20your\x20webpack\x20config\x20â€“\x20style-loader\x20should\x20use\x20data-cke=true\x20attribute\x20for\x20the\x20editor\x20stylesheet.'),[..._0x112242,..._0x4a0003]['join']('\x20')['trim']();}class o extends _0x13cbca{constructor(_0x281a60){super(_0x281a60),this['set']('isBusy',!0x1),this['affectsData']=!0x1;}['refresh'](){this['isEnabled']=!this['isBusy'],this['value']=this['isBusy']?'pending':void 0x0;}['execute'](_0x5686ef={}){const _0x5f2146=this['editor'],t=_0x5f2146['t'],_0x3b57f6=_0x5686ef['converterUrl']||'https://pdf-converter.cke-cs.com/v1/convert/',_0x54adac=_0x5686ef['dataCallback']||(_0x4f3780=>_0x4f3780['data']['get']()),_0x57a6a4=_0x5f2146['plugins']['get']('ExportPdf'),_0x4f9fad=_0x5686ef['token']||_0x57a6a4['_token'];return this['isBusy']=!0x0,this['refresh'](),function(_0x3b22ab){if(!_0x3b22ab)return new Promise(_0x3f69d9=>_0x3f69d9(''));const _0x1b354f=[];for(const _0x123a2a of _0x3b22ab)'EDITOR_STYLES'!==_0x123a2a?_0x1b354f['push'](window['fetch'](_0x123a2a)['then'](_0x1ed5a1=>_0x1ed5a1['text']())):_0x1b354f['push'](f());return Promise['all'](_0x1b354f)['then'](_0x50bd16=>_0x50bd16['join']('\x20')['trim']());}(_0x5686ef['stylesheets']||['EDITOR_STYLES'])['then'](async _0x51705e=>{_0x5f2146['ui']['ariaLiveAnnouncer']['announce'](t('PDF\x20export\x20started'));const _0x56adab={'html':'<html>\x0a\x09\x09\x09\x09\x09\x09<head>\x0a\x09\x09\x09\x09\x09\x09\x09<title>CKEditor\x205\x20PDF\x20document</title>\x0a\x09\x09\x09\x09\x09\x09\x09<meta\x20charset=\x22utf-8\x22>\x0a\x09\x09\x09\x09\x09\x09</head>\x0a\x09\x09\x09\x09\x09\x09<body>\x0a\x09\x09\x09\x09\x09\x09\x09<div\x20class=\x22ck-content\x22\x20dir=\x22'+_0x5f2146['locale']['contentLanguageDirection']+'\x22>\x0a\x09\x09\x09\x09\x09\x09\x09\x09'+await _0x54adac(_0x5f2146)+'\x0a\x09\x09\x09\x09\x09\x09\x09</div>\x0a\x09\x09\x09\x09\x09\x09</body>\x0a\x09\x09\x09\x09\x09</html>','css':_0x51705e,'options':_0x5686ef['converterOptions']},_0x3a7f5d={'method':'POST','headers':{'Content-Type':'application/json','Accept':'application/pdf',..._0x4f9fad?{'Authorization':_0x4f9fad['value']}:null,'x-cs-app-id':_0x5686ef['appID']||'cke5'},'body':JSON['stringify'](_0x56adab)};return window['fetch'](_0x3b57f6,_0x3a7f5d)['then'](_0x9abe07=>{if(0xc8!==_0x9abe07['status'])throw _0x9abe07;return _0x9abe07['blob']();})['then'](_0x303153=>{_0x5f2146['ui']['ariaLiveAnnouncer']['announce'](t('PDF\x20export\x20successful'));const _0x42e131='function'==typeof _0x5686ef['fileName']?_0x5686ef['fileName']():_0x5686ef['fileName'];this['_downloadFile'](_0x303153,_0x42e131||'document.pdf');});})['catch'](_0x1ac557=>{const _0x5e1dd0=_0x5f2146['plugins']['get']('Notification');throw _0x5f2146['ui']['ariaLiveAnnouncer']['announce'](t('PDF\x20export\x20failed'),{'politeness':'assertive'}),_0x5e1dd0['showWarning'](t('An\x20error\x20occurred\x20while\x20generating\x20the\x20PDF.')),_0x1ac557;})['finally'](()=>{this['isBusy']=!0x1,this['refresh']();});}['_downloadFile'](_0x536360,_0x58546c){const _0x95b2f7=document['createElement']('a');_0x95b2f7['href']=window['URL']['createObjectURL'](_0x536360),_0x95b2f7['download']=_0x58546c,_0x95b2f7['click'](),_0x95b2f7['remove']();}}class i extends _0x1e980c{static get['pluginName'](){return'ExportPdfUI';}['init'](){const _0x4406fa=this['editor'];_0x4406fa['ui']['componentFactory']['add']('exportPdf',()=>{const _0x229013=this['_createButton'](_0x4256ab),_0x12a461=_0x4406fa['commands']['get']('exportPdf');return _0x229013['set']({'tooltip':!0x0}),_0x229013['bind']('isOn')['to'](_0x12a461,'isBusy'),_0x229013;}),_0x4406fa['ui']['componentFactory']['add']('menuBar:exportPdf',()=>this['_createButton'](_0xe660d7));}['_createButton'](_0x2aea86){const _0x10341c=this['editor'],_0x14183f=_0x10341c['config']['get']('exportPdf')||{},t=_0x10341c['locale']['t'],_0x24dc19=_0x10341c['commands']['get']('exportPdf'),_0x468eb1=new _0x2aea86(_0x10341c['locale']),_0x404716=new _0xdb7b88();return _0x468eb1['children']['add'](_0x404716),_0x404716['bind']('isVisible')['to'](_0x24dc19,'isBusy'),_0x468eb1['iconView']['bind']('isVisible')['to'](_0x24dc19,'isBusy',_0xd246be=>!_0xd246be),_0x468eb1['set']({'icon':'<svg\x20viewBox=\x220\x200\x2020\x2020\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M19\x204.5\x2014\x200H3v6.5h1.5v-5h8v5h5V11H19V4.5ZM14\x202l3.3\x203H14V2Z\x22/><path\x20d=\x22m12.452\x2018.5\x201.25\x201.5H3v-3h1.5v1.5h7.952Z\x22/><path\x20d=\x22M19.826\x2016.843a.75.75\x200\x201\x200-1.152-.96L17.5\x2017.29V13H16v4.29l-1.174-1.408a.75.75\x200\x201\x200-1.152.96l2.346\x202.816a.95.95\x200\x200\x200\x201.46\x200l2.346-2.815Z\x22/><path\x20d=\x22M1.63\x2014.24V12.3h.88c.66\x200\x201.14-.15\x201.46-.45.32-.3.48-.71.48-1.24\x200-.52-.15-.91-.44-1.2C3.7\x209.15\x203.28\x209\x202.69\x209H0v5.24h1.63Zm.4-3h-.4v-1.17h.46c.3\x200\x20.5.05.62.17.1.11.16.25.16.42\x200\x20.16-.06.3-.19.41-.13.11-.34.16-.66.16l.01.01Zm5.7\x203c.28\x200\x20.6-.05.96-.14.26-.07.5-.21.73-.42.22-.2.4-.47.53-.77.12-.31.19-.75.19-1.3\x200-.37-.04-.7-.13-1.02a2.3\x202.3\x200\x200\x200-.42-.84c-.19-.24-.43-.43-.72-.56C8.57\x209.06\x208.2\x209\x207.72\x209h-2.4v5.24H7.73Zm-.4-1.19h-.4v-2.86h.4c.43\x200\x20.73.1.91.3.18.2.27.59.27\x201.14\x200\x20.42-.04.73-.12.91a.76.76\x200\x200\x201-.34.4c-.14.07-.38.11-.72.11Zm5.3\x201.2V12.1h2.02v-1.06h-2.03v-.91H15V9h-4v5.24h1.62l.01.01Z\x22/></svg>\x0a'}),_0x468eb1['bind']('isEnabled')['to'](_0x24dc19,'isEnabled'),_0x468eb1['bind']('label')['to'](_0x24dc19,'isBusy',_0x33efc5=>t(_0x33efc5?'Exporting\x20PDF\x20document':'Export\x20to\x20PDF')),this['listenTo'](_0x468eb1,'execute',()=>{_0x10341c['execute']('exportPdf',_0x14183f),_0x10341c['editing']['view']['focus']();}),_0x468eb1;}}class s extends _0x1e980c{['_token'];static get['pluginName'](){return'ExportPdf';}static get['requires'](){return['CloudServices',_0xc61cdb,i];}['init'](){const _0x451c40=this['editor'],_0x2175ad=_0x451c40['config']['get']('exportPdf')||{};_0x451c40['commands']['add']('exportPdf',new o(_0x451c40));const _0x5ed044=_0x451c40['plugins']['get']('CloudServices');!0x1===_0x2175ad['tokenUrl']?this['_token']=null:_0x2175ad['tokenUrl']?_0x5ed044['registerTokenUrl'](_0x2175ad['tokenUrl'])['then'](_0x4c195f=>{this['_token']=_0x4c195f;}):this['_token']=_0x5ed044['token'];}}export{s as ExportPdf};