/*
 *             Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
function _0x6663(_0x3b0c03,_0x337716){const _0x157343=_0x1573();return _0x6663=function(_0x666344,_0x4d87e1){_0x666344=_0x666344-0xdf;let _0x2cf360=_0x157343[_0x666344];return _0x2cf360;},_0x6663(_0x3b0c03,_0x337716);}const _0x4891e0=_0x6663;function _0x1573(){const _0x4c5a1f=['Instruction:\x0a','config','1264595jUqlJU','parse','_readStaticResponse','AI_ERROR_CONTEXT_LENGTH','signal','sendRequest','split','_apiUrl','stream','28544VWjwXY','message','_isBufferIncomplete','json','map','ai.openAI.requestHeaders','Moderation','1776306BNpCOR','filter','define','AI_ERROR_MODERATION','_requestHeaders','626163phVfvu','delta','[DONE]','includes','4CPOjYA','body','234370tWPbrP','_prepareRequestParameters','replace','Your\x20task\x20is\x20to\x20generate\x20HTML\x20content\x20accordingly\x20to\x20the\x20given\x20instruction.\x20Never\x20include\x20<img>\x20tag\x20in\x20your\x20response\x20even\x20if\x20asked\x20for.\x20Your\x20answer\x20must\x20be\x20a\x20well-structured\x20and\x20properly\x20formatted\x20HTML\x20code.\x20Answer\x20only\x20with\x20the\x20generated\x20HTML\x20content.\x20Do\x20not\x20add\x20any\x20additional\x20remarks\x20or\x20notes.\x20Do\x20not\x20act\x20like\x20a\x20chatbot\x20or\x20a\x20real\x20person.','length','252891YVyoub','_cleanUpData','editor','abortController','choices','system','stringify','getReader','read','decode','6nfTHYf','content','190MjFsYZ','_prepareRequestHeaders','reject','data:\x20','context_length_exceeded','https://api.openai.com/v1/chat/completions','Your\x20task\x20is\x20to\x20execute\x20the\x20instruction\x20using\x20the\x20provided\x20HTML\x20content.\x20Follow\x20the\x20instruction\x20closely.\x20Your\x20answer\x20must\x20be\x20a\x20properly\x20formatted\x20HTML\x20code.\x20Do\x20not\x20add\x20any\x20additional\x20remarks\x20or\x20notes.\x20Do\x20not\x20act\x20like\x20a\x20chatbot\x20or\x20a\x20real\x20person.','resolve','join','_requestParameters','get','text','prepareMessages','user','pluginName','\x0aYou\x20must\x20keep\x20the\x20text\x20formatting.\x0a\x0aContent:\x0a','80938LeLqqR','gpt-3.5-turbo','locale','ai.openAI.apiUrl','ai.openAI.requestParameters','POST','OpenAITextAdapter','_readStreamableResponse'];_0x1573=function(){return _0x4c5a1f;};return _0x1573();}(function(_0x2e4d8b,_0x17a908){const _0x54436a=_0x6663,_0x1e6ac3=_0x2e4d8b();while(!![]){try{const _0x56a9de=-parseInt(_0x54436a(0x110))/0x1+parseInt(_0x54436a(0xeb))/0x2+-parseInt(_0x54436a(0x10a))/0x3+-parseInt(_0x54436a(0x10e))/0x4*(-parseInt(_0x54436a(0xf5))/0x5)+parseInt(_0x54436a(0x11f))/0x6*(-parseInt(_0x54436a(0x105))/0x7)+parseInt(_0x54436a(0xfe))/0x8+parseInt(_0x54436a(0x115))/0x9*(parseInt(_0x54436a(0x121))/0xa);if(_0x56a9de===_0x17a908)break;else _0x1e6ac3['push'](_0x1e6ac3['shift']());}catch(_0x52ada4){_0x1e6ac3['push'](_0x1e6ac3['shift']());}}}(_0x1573,0x20b64));import{default as _0x58e6ef}from'./aitextadapter.js';import{AIRequestError as _0x1f523e}from'./aiadapter.js';import{getTranslation as _0x10375f}from'../utils/common-translations.js';export default class F extends _0x58e6ef{static get[_0x4891e0(0xe9)](){const _0x1df3aa=_0x4891e0;return _0x1df3aa(0xf1);}constructor(_0x13eca3){const _0x4e7fd6=_0x4891e0;super(_0x13eca3),_0x13eca3[_0x4e7fd6(0xf4)][_0x4e7fd6(0x107)](_0x4e7fd6(0xee),_0x4e7fd6(0xe0)),_0x13eca3[_0x4e7fd6(0xf4)][_0x4e7fd6(0xe5)](_0x4e7fd6(0xef))||_0x13eca3[_0x4e7fd6(0xf4)][_0x4e7fd6(0x107)](_0x4e7fd6(0xef),{'model':_0x4e7fd6(0xec),'max_tokens':0x7d0,'temperature':0x1,'top_p':0x1,'stream':!0x0}),this[_0x4e7fd6(0xfc)]=_0x13eca3[_0x4e7fd6(0xf4)][_0x4e7fd6(0xe5)](_0x4e7fd6(0xee)),this[_0x4e7fd6(0x109)]=_0x13eca3[_0x4e7fd6(0xf4)][_0x4e7fd6(0xe5)](_0x4e7fd6(0x103))||{},this[_0x4e7fd6(0xe4)]=_0x13eca3[_0x4e7fd6(0xf4)][_0x4e7fd6(0xe5)](_0x4e7fd6(0xef));}async[_0x4891e0(0xfa)]({query:_0x572ad6,context:_0x478447,onData:_0x5aa3d8,actionId:_0x2a7426}){const _0x52290d=_0x4891e0,_0x5e92b2=this[_0x52290d(0x117)][_0x52290d(0xed)],_0x408219=await this[_0x52290d(0xe7)](_0x572ad6,_0x478447,_0x2a7426),_0x2f4811=await this[_0x52290d(0x122)](this[_0x52290d(0x109)],_0x2a7426),_0x52b162=await this[_0x52290d(0x111)](this[_0x52290d(0xe4)],_0x2a7426),_0x513f2e={'messages':_0x408219,..._0x52b162},_0x477e41={'method':_0x52290d(0xf0),'headers':_0x2f4811,'body':JSON[_0x52290d(0x11b)](_0x513f2e),'signal':this[_0x52290d(0x118)][_0x52290d(0xf9)]},_0x2e6c0d=await fetch(this[_0x52290d(0xfc)],_0x477e41);if(_0x2e6c0d['ok'])return _0x52b162[_0x52290d(0xfd)]?await this[_0x52290d(0xf2)](_0x2e6c0d,_0x5aa3d8):await this[_0x52290d(0xf7)](_0x2e6c0d,_0x5aa3d8),Promise[_0x52290d(0xe2)]();{const _0x2c2843=await _0x2e6c0d[_0x52290d(0xe6)]();return _0x2c2843[_0x52290d(0x10d)](_0x52290d(0xdf))?Promise[_0x52290d(0x123)](new _0x1f523e(_0x10375f(_0x5e92b2,_0x52290d(0xf8)))):_0x2c2843[_0x52290d(0x10d)](_0x52290d(0x104))?Promise[_0x52290d(0x123)](new _0x1f523e(_0x10375f(_0x5e92b2,_0x52290d(0x108)))):Promise[_0x52290d(0x123)](new Error(_0x2c2843));}}async[_0x4891e0(0xe7)](_0x1c1b88,_0x3ca64b,_0x209edb){const _0x139e53=_0x4891e0;let _0x10097d,_0x25e4b6;return _0x3ca64b?(_0x10097d=_0x139e53(0xe1),_0x25e4b6=_0x139e53(0xf3)+_0x1c1b88+_0x139e53(0xea)+_0x3ca64b):(_0x10097d=_0x139e53(0x113),_0x25e4b6=_0x1c1b88),[{'role':_0x139e53(0x11a),'content':_0x10097d},{'role':_0x139e53(0xe8),'content':_0x25e4b6}];}async[_0x4891e0(0xf2)](_0x4125e2,_0x405cd1){const _0x42aceb=_0x4891e0,_0x5289a3=_0x4125e2[_0x42aceb(0x10f)][_0x42aceb(0x11c)](),_0x37c0c4=new TextDecoder();let _0x4fc496='',_0x4a5dea='',_0x2b26a1='',_0x308105=!0x1;for(;!_0x308105;){const {done:_0x42492e,value:_0x4539c3}=await _0x5289a3[_0x42aceb(0x11d)](),_0x5a682c=_0x4fc496+_0x37c0c4[_0x42aceb(0x11e)](_0x4539c3);let _0x5a5ebc='';_0x308105=_0x42492e;try{_0x5a5ebc=this[_0x42aceb(0x116)](_0x5a682c),_0x4fc496='';}catch(_0x22e7fd){_0x4fc496=_0x5a682c;continue;}_0x4a5dea+=_0x5a5ebc,!_0x308105&&this[_0x42aceb(0x100)](_0x4a5dea)||_0x4a5dea&&(_0x2b26a1+=_0x4a5dea,_0x4a5dea='',_0x405cd1(_0x2b26a1));}return Promise[_0x42aceb(0xe2)]();}async[_0x4891e0(0xf7)](_0x57d5f5,_0xb7dfaf){const _0x125446=_0x4891e0;return _0xb7dfaf((await _0x57d5f5[_0x125446(0x101)]())[_0x125446(0x119)][0x0][_0x125446(0xff)][_0x125446(0x120)]),Promise[_0x125446(0xe2)]();}[_0x4891e0(0x100)](_0x2fbc7f){const _0x16d2ca=_0x4891e0,_0xdcc95b=_0x2fbc7f[_0x16d2ca(0xfb)]('<')[_0x16d2ca(0x114)]!==_0x2fbc7f[_0x16d2ca(0xfb)]('>')[_0x16d2ca(0x114)],_0x4bc083=_0x2fbc7f[_0x16d2ca(0x114)]<0x1e;return _0xdcc95b&&_0x4bc083;}[_0x4891e0(0x116)](_0x3d503f){const _0x1b4546=_0x4891e0;return _0x3d503f[_0x1b4546(0xfb)](/\n(?![^{]*\})/g)[_0x1b4546(0x102)](_0x14d3ce=>_0x14d3ce[_0x1b4546(0x112)](_0x1b4546(0x124),''))[_0x1b4546(0x106)](_0x5cd22c=>_0x5cd22c&&_0x5cd22c[_0x1b4546(0x114)]>0x0&&_0x1b4546(0x10c)!==_0x5cd22c)[_0x1b4546(0x102)](_0x333c76=>{const _0x47ea32=_0x1b4546,{choices:_0x3f954}=JSON[_0x47ea32(0xf6)](_0x333c76);if(_0x3f954[0x0]&&_0x3f954[0x0][_0x47ea32(0x10b)]&&_0x3f954[0x0][_0x47ea32(0x10b)][_0x47ea32(0x120)])return _0x3f954[0x0][_0x47ea32(0x10b)][_0x47ea32(0x120)];})[_0x1b4546(0x106)](_0x3b7443=>_0x3b7443)[_0x1b4546(0xe3)]('');}}