!function(t){const e=t.en=t.en||{};e.dictionary=Object.assign(e.dictionary||{},{"Import from Word":"Import from Word","Importing Word document":"Importing Word document"})}(window.CKEDITOR_TRANSLATIONS||(window.CKEDITOR_TRANSLATIONS={})),
/*!
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md.
 */(()=>{var t={331:(t,e,r)=>{t.exports=r(237)("./src/clipboard.js")},782:(t,e,r)=>{t.exports=r(237)("./src/core.js")},783:(t,e,r)=>{t.exports=r(237)("./src/engine.js")},311:(t,e,r)=>{t.exports=r(237)("./src/ui.js")},584:(t,e,r)=>{t.exports=r(237)("./src/utils.js")},237:t=>{"use strict";t.exports=CKEditor5.dll}},e={};function r(o){var n=e[o];if(void 0!==n)return n.exports;var i=e[o]={exports:{}};return t[o](i,i.exports,r),i.exports}r.d=(t,e)=>{for(var o in e)r.o(e,o)&&!r.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var o={};(()=>{"use strict";r.r(o),r.d(o,{ImportWord:()=>f,ImportWordEditing:()=>u,ImportWordUI:()=>n});var t=r(782),e=r(311);class n extends t.Plugin{static get pluginName(){return"ImportWordUI"}init(){const t=this.editor;t.ui.componentFactory.add("importWord",(()=>{const r=this._createButton(e.FileDialogButtonView),o=t.commands.get("importWord");return r.bind("isOn").to(o,"isBusy"),r.tooltip=!0,r})),t.ui.componentFactory.add("menuBar:importWord",(()=>this._createButton(e.MenuBarMenuListItemFileDialogButtonView)))}_createButton(t){const r=this.editor,o=r.locale.t,n=r.commands.get("importWord"),i=new t(r.locale),s=new e.SpinnerView;return i.set({acceptedType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.openxmlformats-officedocument.wordprocessingml.template"}),i.set({icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m14 0 5 4.5v8.892l-1.5-1.8V6.5h-5v-5h-8v3H3V0h11Zm0 2v3h3.3L14 2Z"/><path d="M10.74 18a2.76 2.76 0 0 1-.469-.5H3V19h9.25v-.374A2.737 2.737 0 0 1 10.74 18Z"/><path d="M8.5 6a1.5 1.5 0 0 1 1.493 1.356L10 7.5v7a1.5 1.5 0 0 1-1.356 1.493L8.5 16h-7a1.5 1.5 0 0 1-1.493-1.356L0 14.5v-7a1.5 1.5 0 0 1 1.356-1.493L1.5 6h7ZM7.483 8.795l-.042.088-.986 2.534-.947-2.528-.043-.092a.601.601 0 0 0-1.042.008l-.042.093-.883 2.465-.937-2.475-.042-.089a.6.6 0 0 0-1.107.42l.027.093 1.514 4 .044.092a.6.6 0 0 0 1.041-.01l.041-.092.88-2.458.925 2.467.046.096a.602.602 0 0 0 1.032 0l.043-.09 1.554-4 .028-.093a.6.6 0 0 0-1.104-.43v.001ZM11.674 15.407a.75.75 0 1 0 1.152.96L14 14.96V20h1.5v-5.04l1.174 1.408a.75.75 0 1 0 1.152-.96l-2.346-2.816a.95.95 0 0 0-1.46 0l-2.346 2.815Z"/></svg>\n'}),i.bind("isEnabled").to(n),i.bind("label").to(n,"isBusy",(t=>o(t?"Importing Word document":"Import from Word"))),s.bind("isVisible").to(n,"isBusy"),i.iconView.bind("isVisible").to(n,"isBusy",(t=>!t)),i.children.add(s),i.on("done",((t,e)=>{r.execute("importWord",e[0],{}),r.editing.view.focus()})),i}}var i=r(331),s=r(783),a=r(584);class c extends t.Command{constructor(t){super(t),this.set("isBusy",!1),this._importMarker=null,this._undoStepBatch=null,this._abortController=null,this.on("dataInsert",((e,r)=>{const o=new DataTransfer;o.setData("text/html",r.html);const n=this._importMarker.getRange();this.editor.model.enqueueChange(this._undoStepBatch,(e=>{this._importMarker.stopListening(),e.setSelection(n),t.editing.view.document.fire("clipboardInput",{dataTransfer:o})}))}),{priority:"low"})}refresh(){this.isEnabled=this._checkEnabled()}execute(t,e={}){if(this.isBusy)return Promise.resolve();const r=this.editor.config.get("importWord"),o={url:r.converterUrl,file:t,serviceConfig:{...e,formatting:r.formatting}};return this._prepareForImport(),this._sendImportRequest(o).then(this._handleImportResponse.bind(this)).catch(this._handleImportFailure.bind(this)).finally(this._cleanUpAfterImport.bind(this))}_checkEnabled(){if(this.isBusy)return!1;const t=this.editor.model,e=t.schema,r=t.document.selection,o=(0,a.first)(r.getSelectedBlocks());return!!o&&e.checkChild(o.parent,"paragraph")}_prepareForImport(){const t=this.editor,e=t.model,r=e.document.selection;this._abortController=new AbortController,this._undoStepBatch=t.model.createBatch({isUndoable:!0}),e.enqueueChange(this._undoStepBatch,(t=>{r.isCollapsed||e.deleteContent(r,{leaveUnmerged:!0});const o=r.getFirstPosition(),n=(0,a.first)(r.getSelectedBlocks());let i;i=n.is("element","paragraph")&&n.isEmpty?o:o.isAtStart?e.createPositionBefore(n):o.isAtEnd?e.createPositionAfter(n):t.split(o).position,this._importMarker=t.addMarker("importWord:"+(0,a.uid)(),{usingOperation:!1,affectsData:!1,range:new s.Range(i)}),this._importMarker.on("change:range",(()=>{"$graveyard"===this._importMarker.getRange().root.rootName&&this._abortController.abort()}))})),this.isBusy=!0,this.refresh()}_cleanUpAfterImport(){const t=this.editor.model;t.markers.has(this._importMarker)&&t.enqueueChange(this._undoStepBatch,(t=>{t.removeMarker(this._importMarker)})),this._importMarker=null,this._undoStepBatch=null,this._abortController=null,this.isBusy=!1,this.refresh()}_sendImportRequest({url:t,file:e,serviceConfig:r}){const o=this.editor.plugins.get("ImportWordEditing").getToken(),n=new FormData;n.set("config",JSON.stringify(r)),n.set("file",e);const i={method:"POST",headers:{},body:n,signal:this._abortController.signal};return o&&(i.headers.Authorization=o.value),fetch(t,i)}_handleImportResponse(t){return t.ok?t.json().then((t=>{this.editor.model.markers.has(this._importMarker)&&"$graveyard"!==this._importMarker.getRange().root.rootName&&this.fire("dataInsert",t)})):Promise.reject()}_handleImportFailure(){if(this._abortController.signal.aborted)return void(0,a.logWarning)("import-word-plugin-import-cancelled");const t=this.editor,e=(0,t.t)("An error occurred while importing the Word file.");t.plugins.get("Notification").showWarning(e),(0,a.logError)("import-word-plugin-conversion-failed")}}function d(){const t=["284NjcZPp","605934mCyGBM","156MjudQO","18198clxCmM","pluginName","https://docx-converter.cke-cs.com/v2/convert/docx-html","commands","30201qLthKe","58056wIjvhM","tokenUrl","editor","define","importWord","6281600babhuS","ImportWordEditing","none","inline","getToken","7830HefcqZ","config","init","token","cloudServices","2859885MgzFLl","registerTokenUrl","32XtdcGy","add","requires","CloudServices","plugins","_token","95VaUgcY","1468973qDMWbh","get"];return(d=function(){return t})()}const p=l;function l(t,e){const r=d();return(l=function(t,e){return r[t-=428]})(t,e)}!function(t,e){const r=l,o=t();for(;;)try{if(918411===-parseInt(r(433))/1+parseInt(r(432))/2*(parseInt(r(439))/3)+-parseInt(r(445))/4+-parseInt(r(429))/5*(-parseInt(r(440))/6)+parseInt(r(455))/7*(parseInt(r(457))/8)+-parseInt(r(435))/9*(-parseInt(r(450))/10)+-parseInt(r(430))/11*(parseInt(r(434))/12))break;o.push(o.shift())}catch(t){o.push(o.shift())}}(d);class u extends t.Plugin{static get[p(436)](){return p(446)}static get[p(459)](){const t=p;return[e.Notification,i.ClipboardPipeline,t(460)]}constructor(t){const e=p;super(t),this[e(428)]=null}async[p(452)](){const t=p,e=this[t(442)];e[t(451)][t(443)](t(444),{converterUrl:t(437),tokenUrl:(e[t(451)][t(431)](t(454))||{})[t(441)],formatting:{resets:t(447),defaults:t(447),styles:t(448)}}),e[t(438)][t(458)](t(444),new c(e));const{tokenUrl:r}=e[t(451)][t(431)](t(444));if(r){const{tokenUrl:o}=e[t(451)][t(431)](t(454))||{};this[t(428)]=r===o?e[t(461)][t(431)](t(460))[t(453)]:await e[t(461)][t(431)](t(460))[t(456)](r)}}[p(449)](){return this[p(428)]}}var h=m;function m(t,e){var r=g();return(m=function(t,e){return r[t-=284]})(t,e)}function g(){var t=["4mAcRpE","9918568EsfjDF","ImportWord","339666EFHefi","92185gqdXdb","243104LNeDQW","requires","910hvFJWv","356881jgwCZV","36YeXCfY","118118ZVaVUY","27936QbzUft","pluginName","4XpShAd"];return(g=function(){return t})()}!function(t,e){for(var r=m,o=t();;)try{if(193049===parseInt(r(296))/1+-parseInt(r(285))/2*(parseInt(r(289))/3)+parseInt(r(286))/4*(parseInt(r(290))/5)+-parseInt(r(295))/6*(parseInt(r(294))/7)+-parseInt(r(291))/8+-parseInt(r(297))/9*(parseInt(r(293))/10)+parseInt(r(287))/11)break;o.push(o.shift())}catch(t){o.push(o.shift())}}(g);class f extends t.Plugin{static get[h(284)](){return h(288)}static get[h(292)](){return[u,n]}}function I(t,e){var r=v();return(I=function(t,e){return r[t-=322]})(t,e)}function v(){var t=["43240lkDuxZ","42775GfhaOR","185445RnQOLc","384652MEQWjD","475812psuTyq","28hqLzFb","150204bGVbTL","665176QnVdFV","6XdAHrl"];return(v=function(){return t})()}!function(t,e){for(var r=I,o=t();;)try{if(121410===-parseInt(r(328))/1*(parseInt(r(326))/2)+parseInt(r(322))/3+parseInt(r(330))/4+-parseInt(r(327))/5+parseInt(r(324))/6*(-parseInt(r(323))/7)+parseInt(r(325))/8+parseInt(r(329))/9)break;o.push(o.shift())}catch(t){o.push(o.shift())}}(v)})(),(window.CKEditor5=window.CKEditor5||{}).importWord=o})();