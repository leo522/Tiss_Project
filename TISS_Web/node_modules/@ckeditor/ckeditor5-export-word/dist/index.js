/*
 *             Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import{Command as _0x1c9425,Plugin as _0x3707c9}from'@ckeditor/ckeditor5-core/dist/index.js';import{ButtonView as _0x5c4151,MenuBarMenuListItemButtonView as _0x100f69,SpinnerView as _0x11fecc,Notification as _0x1b21ed}from'@ckeditor/ckeditor5-ui/dist/index.js';function f(){const _0x534c9c=[],_0x34c035=[];for(const _0x297283 of Array['from'](document['styleSheets'])){if(_0x297283['ownerNode']['hasAttribute']('data-cke')){for(const _0x6605bd of Array['from'](_0x297283['cssRules']))-0x1!==_0x6605bd['cssText']['indexOf']('.ck-content')?_0x534c9c['push'](_0x6605bd['cssText']):-0x1!==_0x6605bd['cssText']['indexOf'](':root')&&_0x34c035['push'](_0x6605bd['cssText']);}}return _0x534c9c['length']||console['warn']('The\x20editor\x20stylesheet\x20could\x20not\x20be\x20found\x20in\x20the\x20document.\x20Check\x20your\x20webpack\x20config\x20â€“\x20style-loader\x20should\x20use\x20data-cke=true\x20attribute\x20for\x20the\x20editor\x20stylesheet.'),[..._0x34c035,..._0x534c9c]['join']('\x20')['trim']();}function d(_0x51e4be){const _0x4e3d57=_0x51e4be['plugins']['has']('Users'),_0x34c8c5=_0x51e4be['plugins']['has']('CommentsRepository'),_0x2ffcbd=_0x51e4be['plugins']['has']('TrackChanges'),_0x4e88d3={};if(_0x4e3d57&&_0x34c8c5){const _0x489809=function(_0x4ffae0){const _0x1472e2={};if(!_0x4ffae0['length'])return _0x1472e2;for(const _0xd2f381 of _0x4ffae0)_0xd2f381['comments']['map'](_0x27be81=>{void 0x0===_0x1472e2[_0xd2f381['id']]&&(_0x1472e2[_0xd2f381['id']]=[]),_0x1472e2[_0xd2f381['id']]['push']({'author':_0x27be81['author']['name'],'content':_0x27be81['content'],'created':_0x27be81['createdAt'],'is_resolved':_0xd2f381['isResolved']});});return _0x1472e2;}(_0x51e4be['plugins']['get']('CommentsRepository')['getCommentThreads']({'skipNotAttached':!0x0,'skipEmpty':!0x0}));Object['keys'](_0x489809)['length']&&(_0x4e88d3['comments']=_0x489809);}if(_0x4e3d57&&_0x2ffcbd){const _0x2d9ffc=_0x51e4be['plugins']['get']('TrackChanges'),_0x663e4d=_0x51e4be['plugins']['get']('Users'),_0x212990=function(_0x3b7311,_0x55d581){const _0x206bec={};if(!_0x3b7311['length']||!_0x55d581['length'])return _0x206bec;for(const _0x28219e of _0x3b7311)_0x206bec[_0x28219e['id']]={'author':_0x55d581['get'](_0x28219e['authorId'])['name'],'created':_0x28219e['createdAt']};return _0x206bec;}(_0x2d9ffc['getSuggestions']({'toJSON':!0x0}),_0x663e4d['users']);Object['keys'](_0x212990)['length']&&(_0x4e88d3['suggestions']=_0x212990);}return(_0x4e88d3['suggestions']||_0x4e88d3['comments'])&&(_0x4e88d3['timezone']=new Intl['DateTimeFormat']()['resolvedOptions']()['timeZone']),_0x4e88d3;}function h(_0x5f00c6){const _0x28839e=_0x5f00c6['plugins']['has']('Users'),_0x35f712=_0x5f00c6['plugins']['has']('CommentsRepository'),_0x3e9632=_0x5f00c6['plugins']['has']('TrackChanges'),_0x2047f6={},_0x3db320={};if(_0x28839e&&_0x35f712){const _0x5fac5b=function(_0x1436d7){const _0x43c356=[];if(!_0x1436d7['length'])return _0x43c356;for(const _0x2187ae of _0x1436d7){const _0xf93622=_0x2187ae['comments']['map'](_0x1d47e4=>({'author':_0x1d47e4['author']['name'],'content':_0x1d47e4['content'],'created_at':_0x1d47e4['createdAt']}));_0x43c356['push']({'thread_id':_0x2187ae['id'],'is_resolved':_0x2187ae['isResolved'],'comments':_0xf93622});}return _0x43c356;}(_0x5f00c6['plugins']['get']('CommentsRepository')['getCommentThreads']({'skipNotAttached':!0x0,'skipEmpty':!0x0}));_0x5fac5b['length']&&(_0x3db320['comment_threads']=_0x5fac5b);}if(_0x28839e&&_0x3e9632){const _0x1318c7=_0x5f00c6['plugins']['get']('TrackChanges'),_0x4b2ef2=_0x5f00c6['plugins']['get']('Users'),_0x466935=function(_0x59b820,_0x46cfba){if(!_0x59b820['length']||!_0x46cfba['length'])return[];return _0x59b820['map'](_0xda18d8=>({'id':_0xda18d8['id'],'author':_0x46cfba['get'](_0xda18d8['authorId'])['name'],'created_at':_0xda18d8['createdAt']}));}(_0x1318c7['getSuggestions']({'toJSON':!0x0}),_0x4b2ef2['users']);_0x466935['length']&&(_0x3db320['suggestions']=_0x466935);}return(_0x3db320['comment_threads']||_0x3db320['suggestions'])&&(_0x2047f6['timezone']=new Intl['DateTimeFormat']()['resolvedOptions']()['timeZone'],_0x2047f6['collaboration_features']=_0x3db320),_0x2047f6;}class e extends _0x1c9425{constructor(_0x5a430b){super(_0x5a430b),this['set']('isBusy',!0x1),this['affectsData']=!0x1;}['refresh'](){this['isEnabled']=!this['isBusy'],this['value']=this['isBusy']?'pending':void 0x0;}['execute'](_0x310e9a={}){const _0x51850d=this['editor'],t=_0x51850d['t'],_0x136c67=0x2===(_0x310e9a['version']||0x1),_0x13bc19=_0x310e9a['converterUrl']||(_0x136c67?'https://docx-converter.cke-cs.com/v2/convert/html-docx':'https://docx-converter.cke-cs.com/v1/convert'),_0x335cbe=_0x310e9a['converterOptions']||{},_0x4c7083=_0x51850d['plugins']['get']('ExportWord'),_0x34e0ce=_0x310e9a['token']||_0x4c7083['_token'],_0x543eeb=!0x1!==_0x335cbe['auto_pagination'],_0x177ddd=_0x310e9a['dataCallback']||(_0x1fdb17=>_0x1fdb17['data']['get']({'pagination':_0x543eeb}));return this['isBusy']=!0x0,this['refresh'](),function(_0x52716a){if(!_0x52716a)return new Promise(_0xa1920c=>_0xa1920c(''));const _0x55d32e=[];for(const _0x3eac84 of _0x52716a)'EDITOR_STYLES'!==_0x3eac84?_0x55d32e['push'](window['fetch'](_0x3eac84)['then'](_0x382f7d=>_0x382f7d['text']())):_0x55d32e['push'](f());return Promise['all'](_0x55d32e)['then'](_0x28d610=>_0x28d610['join']('\x20')['trim']());}(_0x310e9a['stylesheets']||['EDITOR_STYLES'])['then'](async _0x35c281=>{_0x51850d['ui']['ariaLiveAnnouncer']['announce'](t('Word\x20document\x20export\x20started'));const _0x4bdd95=await _0x177ddd(_0x51850d),_0x1f55a2={'html':'<div\x20class=\x22ck-content\x22\x20dir=\x22'+_0x51850d['locale']['contentLanguageDirection']+'\x22>'+_0x4bdd95+'</div>','css':_0x35c281,[_0x136c67?'config':'options']:{..._0x335cbe,..._0x136c67?h(_0x51850d):d(_0x51850d)}},_0x1668bf={'method':'POST','headers':{'Content-Type':'application/json','Accept':'application/docx',..._0x34e0ce?{'Authorization':_0x34e0ce['value']}:null},'body':JSON['stringify'](_0x1f55a2)};return window['fetch'](_0x13bc19,_0x1668bf)['then'](_0x273c3c=>{if(0xc8!==_0x273c3c['status'])throw _0x273c3c;return _0x273c3c['blob']();})['then'](_0x5112f0=>{_0x51850d['ui']['ariaLiveAnnouncer']['announce'](t('Word\x20document\x20export\x20successful'));const _0x49749b='function'==typeof _0x310e9a['fileName']?_0x310e9a['fileName']():_0x310e9a['fileName'];this['_downloadFile'](_0x5112f0,_0x49749b||'document.docx');});})['catch'](_0x3f3133=>{const _0x32c3f1=_0x51850d['plugins']['get']('Notification');throw _0x51850d['ui']['ariaLiveAnnouncer']['announce'](t('Word\x20document\x20export\x20failed'),{'politeness':'assertive'}),_0x32c3f1['showWarning'](t('An\x20error\x20occurred\x20while\x20generating\x20the\x20Word\x20file.')),_0x3f3133;})['finally'](()=>{this['isBusy']=!0x1,this['refresh']();});}['_downloadFile'](_0x76e596,_0x2c2535){const _0x4c8c19=document['createElement']('a');_0x4c8c19['href']=window['URL']['createObjectURL'](_0x76e596),_0x4c8c19['download']=_0x2c2535,_0x4c8c19['click'](),_0x4c8c19['remove']();}}class i extends _0x3707c9{static get['pluginName'](){return'ExportWordUI';}['init'](){const _0x5e6ccc=this['editor'];_0x5e6ccc['ui']['componentFactory']['add']('exportWord',()=>{const _0x33a31c=_0x5e6ccc['commands']['get']('exportWord'),_0x2d32f5=this['_createButton'](_0x5c4151);return _0x2d32f5['set']({'tooltip':!0x0}),_0x2d32f5['bind']('isOn')['to'](_0x33a31c,'isBusy'),_0x2d32f5;}),_0x5e6ccc['ui']['componentFactory']['add']('menuBar:exportWord',()=>this['_createButton'](_0x100f69));}['_createButton'](_0x301b9b){const _0x5becce=this['editor'],_0x127d59=_0x5becce['config']['get']('exportWord')||{},t=_0x5becce['locale']['t'],_0x44b3db=_0x5becce['commands']['get']('exportWord'),_0x18bd8e=new _0x301b9b(_0x5becce['locale']),_0x4dcc4f=new _0x11fecc();return _0x18bd8e['children']['add'](_0x4dcc4f),_0x4dcc4f['bind']('isVisible')['to'](_0x44b3db,'isBusy'),_0x18bd8e['iconView']['bind']('isVisible')['to'](_0x44b3db,'isBusy',_0x14485e=>!_0x14485e),_0x18bd8e['set']({'icon':'<svg\x20viewBox=\x220\x200\x2020\x2020\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M17.826\x2016.843a.75.75\x200\x200\x200-1.152-.96L15.5\x2017.29V12H14v5.29l-1.174-1.408a.75.75\x200\x200\x200-1.152.96l2.346\x202.816a.95.95\x200\x200\x200\x201.46\x200l2.346-2.815Z\x22/><path\x20d=\x22m14\x200\x205\x204.5v9.741a2.737\x202.737\x200\x200\x200-1.5-.617V6.5h-5v-5h-8v3H3V0h11Zm0\x202v3h3.3L14\x202Z\x22/><path\x20d=\x22M3\x2017.5h6.746c.1.22.23.429.391.623l.731.877H3v-1.5Z\x22/><path\x20d=\x22M8.5\x206a1.5\x201.5\x200\x200\x201\x201.493\x201.356L10\x207.5v7a1.5\x201.5\x200\x200\x201-1.356\x201.493L8.5\x2016h-7a1.5\x201.5\x200\x200\x201-1.493-1.356L0\x2014.5v-7a1.5\x201.5\x200\x200\x201\x201.356-1.493L1.5\x206h7ZM7.483\x208.795l-.042.088-.986\x202.534-.947-2.528-.043-.092a.601.601\x200\x200\x200-1.042.008l-.042.093-.883\x202.465-.937-2.475-.042-.089a.6.6\x200\x200\x200-1.107.42l.027.093\x201.514\x204\x20.044.092a.6.6\x200\x200\x200\x201.041-.01l.041-.092.88-2.458.925\x202.467.046.096a.6.6\x200\x200\x200\x201.032\x200l.043-.09\x201.554-4\x20.028-.093a.6.6\x200\x200\x200-1.104-.43v.001Z\x22/></svg>\x0a'}),_0x18bd8e['bind']('isEnabled')['to'](_0x44b3db,'isEnabled'),_0x18bd8e['bind']('label')['to'](_0x44b3db,'isBusy',_0x3a4eb9=>t(_0x3a4eb9?'Exporting\x20Word\x20document':'Export\x20to\x20Word')),this['listenTo'](_0x18bd8e,'execute',()=>{_0x5becce['execute']('exportWord',_0x127d59),_0x5becce['editing']['view']['focus']();}),_0x18bd8e;}}class s extends _0x3707c9{['_token'];static get['pluginName'](){return'ExportWord';}static get['requires'](){return['CloudServices',_0x1b21ed,i];}['init'](){const _0x4fdb5b=this['editor'],_0xdf66f3=_0x4fdb5b['config']['get']('exportWord')||{};_0x4fdb5b['commands']['add']('exportWord',new e(_0x4fdb5b));const _0x39d82a=_0x4fdb5b['plugins']['get']('CloudServices');!0x1===_0xdf66f3['tokenUrl']?this['_token']=null:_0xdf66f3['tokenUrl']?_0x39d82a['registerTokenUrl'](_0xdf66f3['tokenUrl'])['then'](_0x435d94=>{this['_token']=_0x435d94;}):this['_token']=_0x39d82a['token'];}}export{s as ExportWord};