/*
 *             Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import{Command as _0x23e4de}from'ckeditor5/src/core.js';import{getStyles as _0x14c288,getConverterOptions as _0x3302bb,getConverterOptionsV2 as _0x468d80}from'./utils.js';export default class e extends _0x23e4de{constructor(_0x4bb319){super(_0x4bb319),this['set']('isBusy',!0x1),this['affectsData']=!0x1;}['refresh'](){this['isEnabled']=!this['isBusy'],this['value']=this['isBusy']?'pending':void 0x0;}['execute'](_0x2bf850={}){const _0xeaa10f=this['editor'],t=_0xeaa10f['t'],_0x24c2cc=0x2===(_0x2bf850['version']||0x1),_0x4ed995=_0x2bf850['converterUrl']||(_0x24c2cc?'https://docx-converter.cke-cs.com/v2/convert/html-docx':'https://docx-converter.cke-cs.com/v1/convert'),_0x2d6d1c=_0x2bf850['converterOptions']||{},_0x2123f0=_0xeaa10f['plugins']['get']('ExportWord'),_0xe95f86=_0x2bf850['token']||_0x2123f0['_token'],_0x326feb=!0x1!==_0x2d6d1c['auto_pagination'],_0x82f71e=_0x2bf850['dataCallback']||(_0x7158fb=>_0x7158fb['data']['get']({'pagination':_0x326feb}));return this['isBusy']=!0x0,this['refresh'](),_0x14c288(_0x2bf850['stylesheets']||['EDITOR_STYLES'])['then'](async _0xb37090=>{_0xeaa10f['ui']['ariaLiveAnnouncer']['announce'](t('Word\x20document\x20export\x20started'));const _0x4906f1=await _0x82f71e(_0xeaa10f),_0x3f9efc={'html':'<div\x20class=\x22ck-content\x22\x20dir=\x22'+_0xeaa10f['locale']['contentLanguageDirection']+'\x22>'+_0x4906f1+'</div>','css':_0xb37090,[_0x24c2cc?'config':'options']:{..._0x2d6d1c,..._0x24c2cc?_0x468d80(_0xeaa10f):_0x3302bb(_0xeaa10f)}},_0x2496dd={'method':'POST','headers':{'Content-Type':'application/json','Accept':'application/docx',..._0xe95f86?{'Authorization':_0xe95f86['value']}:null},'body':JSON['stringify'](_0x3f9efc)};return window['fetch'](_0x4ed995,_0x2496dd)['then'](_0x3f31f9=>{if(0xc8!==_0x3f31f9['status'])throw _0x3f31f9;return _0x3f31f9['blob']();})['then'](_0x34ccc0=>{_0xeaa10f['ui']['ariaLiveAnnouncer']['announce'](t('Word\x20document\x20export\x20successful'));const _0x657126='function'==typeof _0x2bf850['fileName']?_0x2bf850['fileName']():_0x2bf850['fileName'];this['_downloadFile'](_0x34ccc0,_0x657126||'document.docx');});})['catch'](_0xf77da3=>{const _0x489a90=_0xeaa10f['plugins']['get']('Notification');throw _0xeaa10f['ui']['ariaLiveAnnouncer']['announce'](t('Word\x20document\x20export\x20failed'),{'politeness':'assertive'}),_0x489a90['showWarning'](t('An\x20error\x20occurred\x20while\x20generating\x20the\x20Word\x20file.')),_0xf77da3;})['finally'](()=>{this['isBusy']=!0x1,this['refresh']();});}['_downloadFile'](_0x1a43a2,_0x153e85){const _0x44d861=document['createElement']('a');_0x44d861['href']=window['URL']['createObjectURL'](_0x1a43a2),_0x44d861['download']=_0x153e85,_0x44d861['click'](),_0x44d861['remove']();}}